# 第一版sigsegv信号处理方案设计
## 已实现功能
1. 仅是在某进程发生访存错误时将该子进程停止，但是需保证不能影响父进程的运行，对应于车载系统中即使某项功能出现访存问题无法使用，但是其影响止于该功能，不会影响整个车载系统。
![sigsegv信号处理结果](./img/第一版sigsegv处理结果.png)
1. 通过查找资料和阅读代码，了解内核发送sigsegv的流程。据此通过内联汇编输出异常发生时程序的处理器状态。
## 原理
1. 内核信号处理流程
- 用户态程序发生访存问题时（取指或取数），发生中止异常，处理器会自陷进入到异常模式。
- 在进入异常模式时，处理程序会将异常发生前的状态按照一定的约束保存入进程内核态的栈空间
- 从低到高：X0-X30，sp，pc，pstate（cpsr），需要注意的是，由于异常发生时，pc和cpsr的值已经保存入ELR_EL1和spsr_EL1，在进行现场保存时，保存的是这两个寄存器的值，便于异常嵌套。
2. signal信号的拦截与处理
## 改进方向
1. signal信号的处理与拦截只是使用了最简单的方式，未携带任何附加信息，计划使用高级的信号拦截与处理方式，以便使用附加信息对出错进程进行更全面和优雅的处理。
2. 功能还不太完善，对某进程死循环的检测与处理还未实现，无法对可能出现的系统因某个功能而卡死的现象进行处理。
